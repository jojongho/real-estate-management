# AppSheet 고정값 시트 재구성 가이드

## 🎯 목표

기존 **데이터확인_list** 시트를 AppSheet Ref 방식에 맞게 개별 참조 테이블로 재구성

**기존 방식** (스프레드시트 드롭다운):
```
=데이터확인_list[거래유형]  → 드롭다운 완성
```

**새로운 방식** (AppSheet Ref):
```
개별 시트 생성 → AppSheet에서 Ref로 참조 → 모든 매물 유형(아파트, 상가, 원투룸)에 공통 적용
```

---

## 📊 현재 데이터 구조 분석

### 데이터확인_list 시트 (현재)
```
| 담당자 | 성별 | 용도지역 | 지목 | 건축물명 | 주택유형 | 난방방식 | 건축물구조 | 거래유형 | 월부담 |
|--------|------|----------|------|----------|----------|----------|-----------|----------|--------|
| 홍길동 | 남   | 상업지역 | 대지 | 아파트   | 아파트   | 개별난방 | 철근콘크리트 | 매매 | 3룸 |
| 김철수 | 여   | 주거지역 | 전   | 빌라     | 다세대   | 중앙난방 | 철골조   | 전세 | 투룸 |
```

**문제점**: 모든 속성이 섞여 있어서 AppSheet Ref로 사용 불가

---

## 🔧 해결 방법: Google Sheets 수식으로 자동 분리

### Step 1: 고정값 스프레드시트에 새 시트 생성

**필요한 개별 시트 목록**:
1. ✅ 거래유형_목록
2. ✅ 난방방식_목록
3. ✅ 용도지역_목록
4. ✅ 지목_목록
5. ✅ 주택유형_목록
6. ✅ 건축물구조_목록
7. ✅ 성별_목록
8. ✅ 담당자_목록

---

## 📋 실행 계획: Google Sheets 작업

### 방법 1: UNIQUE 수식으로 자동 추출 (추천 ⭐⭐⭐)

#### 1-1. 거래유형_목록 시트 생성

**Google Sheets 작업**:
```
1. 고정값 스프레드시트(1cFePAgehODmcTiPoWoDKOg2kIZSd2Zu2ZaiFL36ucVE) 열기
2. 새 시트 생성: 이름 "거래유형_목록"
3. A1 셀에 헤더: "거래유형"
4. A2 셀에 수식 입력:
   =UNIQUE(FILTER(데이터확인_list!I:I, 데이터확인_list!I:I<>""))

설명:
- UNIQUE(): 중복 제거
- FILTER(): 빈 셀 제외
- 데이터확인_list!I:I → I열이 거래유형 컬럼이라고 가정 (실제 열 위치 확인 필요)
```

**결과 예시**:
```
| 거래유형 |
|----------|
| 매매     |
| 전세     |
| 월세     |
| 임대     |
```

#### 1-2. 난방방식_목록 시트 생성

```
1. 새 시트: "난방방식_목록"
2. A1: "난방방식"
3. A2: =UNIQUE(FILTER(데이터확인_list!G:G, 데이터확인_list!G:G<>""))

결과:
| 난방방식 |
|----------|
| 개별난방 |
| 중앙난방 |
| 지역난방 |
| 기타     |
```

#### 1-3. 용도지역_목록 시트 생성

```
1. 새 시트: "용도지역_목록"
2. A1: "용도지역"
3. A2: =UNIQUE(FILTER(데이터확인_list!C:C, 데이터확인_list!C:C<>""))
```

#### 1-4. 지목_목록 시트 생성

```
1. 새 시트: "지목_목록"
2. A1: "지목"
3. A2: =UNIQUE(FILTER(데이터확인_list!D:D, 데이터확인_list!D:D<>""))
```

#### 1-5. 주택유형_목록 시트 생성

```
1. 새 시트: "주택유형_목록"
2. A1: "주택유형"
3. A2: =UNIQUE(FILTER(데이터확인_list!F:F, 데이터확인_list!F:F<>""))

결과 예시:
| 주택유형 |
|----------|
| 아파트   |
| 빌라     |
| 오피스텔 |
| 단독주택 |
| 다세대   |
```

#### 1-6. 건축물구조_목록 시트 생성

```
1. 새 시트: "건축물구조_목록"
2. A1: "건축물구조"
3. A2: =UNIQUE(FILTER(데이터확인_list!H:H, 데이터확인_list!H:H<>""))
```

#### 1-7. 성별_목록 시트 생성

```
1. 새 시트: "성별_목록"
2. A1: "성별"
3. A2: =UNIQUE(FILTER(데이터확인_list!B:B, 데이터확인_list!B:B<>""))

결과:
| 성별 |
|------|
| 남   |
| 여   |
```

#### 1-8. 담당자_목록 시트 생성

```
1. 새 시트: "담당자_목록"
2. A1: "담당자"
3. A2: =UNIQUE(FILTER(데이터확인_list!A:A, 데이터확인_list!A:A<>""))

결과 예시:
| 담당자 |
|--------|
| 홍길동 |
| 김철수 |
| 이영희 |
```

---

### 방법 2: 수동 입력 (빠르지만 관리 불편)

각 시트에 직접 값 입력:

```
거래유형_목록:
| 거래유형 |
|----------|
| 매매     |
| 전세     |
| 월세     |
| 임대     |

난방방식_목록:
| 난방방식 |
|----------|
| 개별난방 |
| 중앙난방 |
| 지역난방 |
| 기타     |
```

**장점**: 빠름
**단점**: 데이터확인_list에 새 값 추가 시 수동 업데이트 필요

---

## 🎯 AppSheet 적용 (Google Sheets 작업 완료 후)

### Step 2: AppSheet에 참조 테이블 추가

#### 2-1. 모든 목록 시트를 AppSheet에 추가

```
AppSheet 작업:

1. Data 메뉴
2. + Add table (8번 반복)

추가할 테이블:
□ 거래유형_목록
□ 난방방식_목록
□ 용도지역_목록
□ 지목_목록
□ 주택유형_목록
□ 건축물구조_목록
□ 성별_목록
□ 담당자_목록

각 테이블 추가 시:
- Spreadsheet ID: 1cFePAgehODmcTiPoWoDKOg2kIZSd2Zu2ZaiFL36ucVE
- Sheet: 해당 시트명 선택
```

---

### Step 3: 각 매물 테이블에 Ref 설정

#### 3-1. 아파트매물 테이블

```
Data → Columns → 아파트매물

□ 거래유형:
   Type: Ref
   Source table: 거래유형_목록
   Label column: 거래유형

□ 난방방식:
   Type: Ref
   Source table: 난방방식_목록
   Label column: 난방방식

□ 용도지역:
   Type: Ref
   Source table: 용도지역_목록
   Label column: 용도지역

□ 지목:
   Type: Ref
   Source table: 지목_목록
   Label column: 지목

□ 주택유형:
   Type: Ref
   Source table: 주택유형_목록
   Label column: 주택유형

□ 건축물구조:
   Type: Ref
   Source table: 건축물구조_목록
   Label column: 건축물구조
```

#### 3-2. 상가매물 테이블 (동일한 Ref 사용)

```
Data → Columns → 상가매물

동일하게 설정:
□ 거래유형 → Ref: 거래유형_목록
□ 난방방식 → Ref: 난방방식_목록
□ 용도지역 → Ref: 용도지역_목록
...
```

#### 3-3. 원투룸매물 테이블 (동일한 Ref 사용)

```
모든 매물 유형에서 동일한 참조 테이블 재사용!
```

---

## ✅ 장점: Ref 방식의 이점

### 1. 중앙 관리
```
거래유형_목록 시트에서 한 번만 수정
→ 아파트, 상가, 원투룸 모든 매물에 자동 반영
```

### 2. 데이터 일관성
```
수동 입력 실수 방지
모든 매물이 동일한 옵션 사용
```

### 3. 확장성
```
새 매물 유형 추가 시 동일한 Ref 테이블 재사용
예: 토지매물, 건물매물 추가 → 같은 거래유형_목록 사용
```

### 4. 자동 업데이트 (UNIQUE 수식 사용 시)
```
데이터확인_list에 새 값 추가
→ UNIQUE 수식이 자동으로 새 값 추출
→ AppSheet Sync만 하면 즉시 반영
```

---

## 📋 실행 체크리스트

### Phase 1: Google Sheets 작업 (20분)

```
□ 고정값 스프레드시트 열기 (1cFePAgehODmcTiPoWoDKOg2kIZSd2Zu2ZaiFL36ucVE)

□ 데이터확인_list 시트에서 각 컬럼 위치 확인
   - A열: 담당자
   - B열: 성별
   - C열: 용도지역
   - D열: 지목
   - E열: ?
   - F열: 주택유형
   - G열: 난방방식
   - H열: 건축물구조
   - I열: 거래유형
   - J열: 월부담

□ 8개 새 시트 생성:
   □ 거래유형_목록 + UNIQUE 수식
   □ 난방방식_목록 + UNIQUE 수식
   □ 용도지역_목록 + UNIQUE 수식
   □ 지목_목록 + UNIQUE 수식
   □ 주택유형_목록 + UNIQUE 수식
   □ 건축물구조_목록 + UNIQUE 수식
   □ 성별_목록 + UNIQUE 수식
   □ 담당자_목록 + UNIQUE 수식

□ 각 시트에서 UNIQUE 수식 결과 확인
```

---

### Phase 2: AppSheet 테이블 추가 (10분)

```
□ AppSheet → Data → + Add table (8번)

□ 추가된 테이블 확인:
   □ 거래유형_목록 ✅
   □ 난방방식_목록 ✅
   □ 용도지역_목록 ✅
   □ 지목_목록 ✅
   □ 주택유형_목록 ✅
   □ 건축물구조_목록 ✅
   □ 성별_목록 ✅
   □ 담당자_목록 ✅
```

---

### Phase 3: Ref 설정 (매물 테이블별 10분)

#### 아파트매물
```
□ 거래유형: Type = Ref, Source = 거래유형_목록
□ 난방방식: Type = Ref, Source = 난방방식_목록
□ 용도지역: Type = Ref, Source = 용도지역_목록
□ 지목: Type = Ref, Source = 지목_목록
□ 주택유형: Type = Ref, Source = 주택유형_목록
□ 건축물구조: Type = Ref, Source = 건축물구조_목록
```

#### 상가매물 (동일)
```
□ 거래유형 → 거래유형_목록
□ 난방방식 → 난방방식_목록
...
```

#### 원투룸매물 (동일)
```
□ 거래유형 → 거래유형_목록
□ 난방방식 → 난방방식_목록
...
```

---

## 🚀 완료 후 검증

### 테스트 시나리오

#### 1. 중앙 관리 검증
```
1. 거래유형_목록 시트에 "단기임대" 추가
2. AppSheet Sync
3. 아파트, 상가, 원투룸 모든 매물의 거래유형 드롭다운에서 "단기임대" 확인 ✅
```

#### 2. 자동 업데이트 검증 (UNIQUE 수식 사용 시)
```
1. 데이터확인_list에 새 데이터 추가 (예: 거래유형 "렌트")
2. 거래유형_목록 시트 확인 → UNIQUE 수식이 자동으로 "렌트" 추출 ✅
3. AppSheet Sync
4. 모든 매물 테이블에서 "렌트" 옵션 사용 가능 ✅
```

#### 3. 데이터 일관성 검증
```
1. 아파트매물 Form → 거래유형 드롭다운 확인
2. 상가매물 Form → 거래유형 드롭다운 확인
3. 두 드롭다운의 옵션 목록이 동일한지 확인 ✅
```

---

## 💡 추가 개선 아이디어

### 1. 순서 컬럼 추가 (정렬 제어)

```
거래유형_목록 시트 구조 개선:
| 순서 | 거래유형 |
|------|----------|
| 1    | 매매     |
| 2    | 전세     |
| 3    | 월세     |
| 4    | 임대     |

AppSheet 정렬 설정:
UX → Views → 아파트매물_Form → 거래유형 → Sort by: 순서
```

### 2. 설명 컬럼 추가 (추가 정보)

```
난방방식_목록 시트:
| 난방방식 | 설명           | 에너지효율 |
|----------|----------------|------------|
| 개별난방 | 세대별 보일러  | 높음       |
| 중앙난방 | 건물 통합 난방 | 중간       |
| 지역난방 | 지역 열 공급   | 높음       |

AppSheet에서 설명 활용:
Virtual Column 또는 Detail View에서 표시
```

### 3. 활성화 상태 컬럼 (옵션 숨김/표시 제어)

```
거래유형_목록:
| 거래유형 | 활성화 |
|----------|--------|
| 매매     | TRUE   |
| 전세     | TRUE   |
| 월세     | TRUE   |
| 임대     | FALSE  | ← 숨김

AppSheet Valid_If:
SELECT(거래유형_목록[거래유형], [활성화] = TRUE)
```

---

## 🎯 최종 권장 구조

### 최소 구조 (시작용)
```
| 속성명   |
|----------|
| 값1      |
| 값2      |
```

### 권장 구조 (실무용)
```
| 순서 | 속성명   | 활성화 |
|------|----------|--------|
| 1    | 값1      | TRUE   |
| 2    | 값2      | TRUE   |
```

### 고급 구조 (향후 확장)
```
| 순서 | 속성명   | 설명       | 활성화 | 카테고리 |
|------|----------|------------|--------|----------|
| 1    | 값1      | 상세 설명  | TRUE   | 기본     |
| 2    | 값2      | 상세 설명  | TRUE   | 기본     |
```

---

## 📞 다음 단계

**즉시 시작 가능한 작업**:
1. 고정값 스프레드시트에서 데이터확인_list의 컬럼 순서 확인
2. UNIQUE 수식으로 8개 목록 시트 생성
3. AppSheet에 8개 테이블 추가
4. 아파트매물부터 Ref 설정 시작

**스크린샷 필요 시**:
- 데이터확인_list 시트 구조 (컬럼명과 위치)
- UNIQUE 수식 실행 결과

---

**작성일**: 2025-10-18
**버전**: 1.0
**참고**: 기존 `=데이터확인_list[거래유형]` 방식을 AppSheet Ref 방식으로 전환
