## 1. ì‹œìŠ¤í…œ ê°œìš”

### 1.1. ëª©ì 

ë³¸ ì‹œìŠ¤í…œì€ Google Workspace(Sheets, Apps Script, Drive)ë¥¼ í™œìš©í•˜ì—¬ ë¶€ë™ì‚° ë§¤ë¬¼ ì •ë³´ì˜ ë“±ë¡, ìˆ˜ì •, ê´€ë¦¬ ì—…ë¬´ë¥¼ ìë™í™”í•˜ê³ , ë°ì´í„°ì˜ ì •í™•ì„±ê³¼ ì—…ë¬´ íš¨ìœ¨ì„ ê·¹ëŒ€í™”í•˜ëŠ” ê²ƒì„ ëª©ì ìœ¼ë¡œ í•œë‹¤.

### 1.2. ì£¼ìš” ê¸°ëŠ¥

- ì‹ ê·œ ë° ê¸°ì¡´ ë§¤ë¬¼ ìë™ íŒë³„
    
- ë§¤ë¬¼ ì •ë³´ì˜ ì‹ ê·œ ë“±ë¡ ë° ìˆ˜ì •(ë®ì–´ì“°ê¸°)
    
- Google Drive ë‚´ ê´€ë ¨ íŒŒì¼ í´ë” ìë™ ìƒì„± ë° ì—°ê²°
    
- ê¸°ì¡´ ë§¤ë¬¼ ì •ë³´ ìë™ ë¶ˆëŸ¬ì˜¤ê¸°
    

### 1.3. ì‘ë™ êµ¬ì¡°

ì‹œìŠ¤í…œì€ Google Sheetsë¥¼ í•µì‹¬ UI ë° ë°ì´í„°ë² ì´ìŠ¤ë¡œ ì‚¬ìš©í•˜ë©°, Google Apps Scriptê°€ ì‚¬ìš©ìì˜ ë™ì‘(ë²„íŠ¼ í´ë¦­, ë©”ë‰´ ì„ íƒ)ì— ë”°ë¼ ì •í•´ì§„ ë¡œì§ì„ ìˆ˜í–‰í•˜ì—¬ ë°ì´í„°ë¥¼ ì²˜ë¦¬í•˜ê³  Google Driveì— íŒŒì¼ì„ ì •ë¦¬í•˜ëŠ” ë°©ì‹ìœ¼ë¡œ ì‘ë™í•œë‹¤.

`[ì‚¬ìš©ì ì…ë ¥ (ë“±ë¡ê²€ìƒ‰ ì‹œíŠ¸)]` â†’ `[ìë™í™” ì²˜ë¦¬ (Apps Script)]` â†’ `[ë°ì´í„° ì €ì¥ (DB ì‹œíŠ¸ & Google Drive)]`

---

## 2. ì‹œíŠ¸ êµ¬ì„± ë° ì—­í• 

ë³¸ ì‹œìŠ¤í…œì€ í•˜ë‚˜ì˜ Google Sheets íŒŒì¼ ì•ˆì— ì—¬ëŸ¬ ì‹œíŠ¸ê°€ ê°ìì˜ ì—­í• ì„ ìˆ˜í–‰í•˜ë©° ìœ ê¸°ì ìœ¼ë¡œ ì—°ê²°ëœë‹¤.

|ì‹œíŠ¸ ì´ë¦„|ì—­í• |ì£¼ìš” ì„¤ëª…|
|---|---|---|
|**`ë“±ë¡ê²€ìƒ‰`**|ì‚¬ìš©ì ì¸í„°í˜ì´ìŠ¤(UI)|ë§¤ë¬¼ì„ ë“±ë¡/ìˆ˜ì •/ì¡°íšŒí•˜ëŠ” ë©”ì¸ í™”ë©´. ëª¨ë“  ìŠ¤í¬ë¦½íŠ¸ ë™ì‘ì˜ ì‹œì‘ì .|
|**`ë§¤ë¬¼DB`**|ë§¤ë¬¼ ë°ì´í„°ë² ì´ìŠ¤|ëª¨ë“  ë§¤ë¬¼ì˜ ìƒì„¸ ì •ë³´ê°€ ê¸°ë¡ë˜ê³  ëˆ„ì ë˜ëŠ” í•µì‹¬ ë°ì´í„° ì‹œíŠ¸.|
|**`ê³ ê°DB`**|ê³ ê° ë°ì´í„°ë² ì´ìŠ¤|ë§¤ë„/ì„ëŒ€ì¸ ë“± ê³ ê° ì •ë³´ê°€ ê¸°ë¡ë˜ëŠ” CRM ë°ì´í„° ì‹œíŠ¸.|
|**`ì•„íŒŒíŠ¸ë‹¨ì§€`**|ì°¸ì¡° ë°ì´í„°ë² ì´ìŠ¤|ì•„íŒŒíŠ¸ ë‹¨ì§€ë³„ ê³ ì • ì •ë³´(ì£¼ì†Œ, ì„¸ëŒ€ìˆ˜ ë“±)ë¥¼ ì €ì¥. `ë§¤ë¬¼ID` ìƒì„± ë“±ì— ì°¸ì¡°ë¨.|
|**`ê³ ì •ê°’(ìˆ˜ì •X)`**|ì„¤ì • ê°’|ê±°ë˜ ìœ í˜•, ìƒíƒœ ë“± ë“œë¡­ë‹¤ìš´ ë©”ë‰´ì— ì‚¬ìš©ë  ê³ ì • ê°’ ëª©ë¡.|

---

## 3. ì£¼ìš” ê¸°ëŠ¥ ë° ì‘ë™ ì›ë¦¬

### 3.1. ì‹ ê·œ/ê¸°ì¡´ ë§¤ë¬¼ ìë™ íŒë³„

- **ìœ„ì¹˜**: `ë“±ë¡ê²€ìƒ‰` ì‹œíŠ¸, `C3` ì…€
    
- **ì›ë¦¬**: ì‚¬ìš©ìê°€ `C4`(ë‹¨ì§€ëª…), `C5`(ë™), `C6`(í˜¸)ë¥¼ ì…ë ¥í•˜ë©´, `FILTER` í•¨ìˆ˜ê°€ `ë§¤ë¬¼DB`ì—ì„œ ë™ì¼í•œ ì¡°ê±´ì˜ ë°ì´í„°ê°€ ìˆëŠ”ì§€ ì‹¤ì‹œê°„ìœ¼ë¡œ ê²€ìƒ‰í•œë‹¤. `COUNTA` í•¨ìˆ˜ë¡œ ê²€ìƒ‰ëœ ë°ì´í„°ì˜ ê°œìˆ˜ë¥¼ ì„¸ì–´ 1ê°œ ì´ìƒì´ë©´ "ë§¤ë¬¼ ìˆìŒ", ì—†ìœ¼ë©´ "ì‹ ê·œ ë§¤ë¬¼"ì„ í‘œì‹œí•œë‹¤.
    
- **í•„ìˆ˜ ìˆ˜ì‹ (`C3` ì…€):**
    
    Excel
    
    ```
    =IF(C4=""&C5=""&C6="", "", IF(COUNTA(FILTER(ë§¤ë¬¼DB!A:A, ë§¤ë¬¼DB!A:A=C4, ë§¤ë¬¼DB!B:B=C5, ë§¤ë¬¼DB!C:C=C6))>0, "ğŸ  ë§¤ë¬¼ ìˆìŒ (ìˆ˜ì • ëª¨ë“œ)", "âœ¨ ì‹ ê·œ ë§¤ë¬¼ (ë“±ë¡ ëª¨ë“œ)"))
    ```
    

### 3.2. ë§¤ë¬¼ ì •ë³´ ë“±ë¡ ë° ìˆ˜ì • (`registerPropertyAndClient` í•¨ìˆ˜)

- **íŠ¸ë¦¬ê±°**: `[ë“±ë¡í•˜ê¸°]` ë²„íŠ¼ í´ë¦­
    
- **ì‘ë™ ìˆœì„œ**:
    
    1. `C3` ì…€ì˜ ìƒíƒœ ê°’("ì‹ ê·œ" ë˜ëŠ” "ë§¤ë¬¼ ìˆìŒ")ì„ ì½ëŠ”ë‹¤.
        
    2. `ë“±ë¡ê²€ìƒ‰` ì‹œíŠ¸ì˜ `Bì—´`(ë¼ë²¨)ê³¼ `Cì—´`(ê°’)ì˜ ëª¨ë“  ë°ì´í„°ë¥¼ ìˆ˜ì§‘í•œë‹¤.
        
    3. **"ì‹ ê·œ ë§¤ë¬¼"ì¼ ê²½ìš°**:
        
        - ìˆ˜ì§‘ëœ ë°ì´í„°ë¥¼ `ë§¤ë¬¼DB`ì™€ `ê³ ê°DB`ì˜ ë§ˆì§€ë§‰ í–‰ì— **ìƒˆë¡­ê²Œ ì¶”ê°€(`appendRow`)**í•œë‹¤.
            
    4. **"ë§¤ë¬¼ ìˆìŒ"ì¼ ê²½ìš°**:
        
        - `ë§¤ë¬¼DB`ì—ì„œ `ë‹¨ì§€ëª…`, `ë™`, `í˜¸`ê°€ ì¼ì¹˜í•˜ëŠ” í–‰ì„ ì°¾ëŠ”ë‹¤.
            
        - í•´ë‹¹ í–‰ì˜ ë°ì´í„°ë¥¼ ìˆ˜ì§‘ëœ ìƒˆ ë°ì´í„°ë¡œ **ë®ì–´ì“´ë‹¤(`setValues`)**.
            
    5. ì‘ì—… ì™„ë£Œ í›„ `ë“±ë¡ê²€ìƒ‰` ì‹œíŠ¸ì˜ ì…ë ¥ ê°’ì„ ì´ˆê¸°í™”í•œë‹¤.
        

### 3.3. ê¸°ì¡´ ë§¤ë¬¼ ì •ë³´ ë¶ˆëŸ¬ì˜¤ê¸° (`loadPropertyData` í•¨ìˆ˜)

- **íŠ¸ë¦¬ê±°**: `[ë¶ˆëŸ¬ì˜¤ê¸°]` ë²„íŠ¼ í´ë¦­
    
- **ì‘ë™ ìˆœì„œ**:
    
    1. `C3` ì…€ì´ "ë§¤ë¬¼ ìˆìŒ" ìƒíƒœì¸ì§€ í™•ì¸í•œë‹¤.
        
    2. `C4`(ë‹¨ì§€ëª…), `C5`(ë™), `C6`(í˜¸) ê°’ì„ í‚¤(Key)ë¡œ ì‚¬ìš©í•œë‹¤.
        
    3. `ë§¤ë¬¼DB`ì—ì„œ í‚¤ ê°’ê³¼ ì¼ì¹˜í•˜ëŠ” í–‰ì˜ ëª¨ë“  ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¨ë‹¤.
        
    4. ê°€ì ¸ì˜¨ ë°ì´í„°ë¥¼ `ë“±ë¡ê²€ìƒ‰` ì‹œíŠ¸ `C`ì—´ì˜ ê° ë¼ë²¨ì— ë§ê²Œ ì±„ì›Œ ë„£ëŠ”ë‹¤.
        

### 3.4. ê´€ë ¨ íŒŒì¼ í´ë” ìë™ ìƒì„± (`createAndLinkFolder` í•¨ìˆ˜)

- **íŠ¸ë¦¬ê±°**: ìƒë‹¨ ë©”ë‰´ `[ğŸ“ ë§¤ë¬¼ í´ë” ê´€ë¦¬] > [ê´€ë ¨íŒŒì¼ í´ë” ìƒì„± ë° ë§í¬]` í´ë¦­
    
- **ì‘ë™ ìˆœì„œ**:
    
    1. `C4`(ë‹¨ì§€ëª…), `C5`(ë™), `C6`(í˜¸) ê°’ì„ ì½ëŠ”ë‹¤.
        
    2. ìŠ¤í¬ë¦½íŠ¸ì— ì§€ì •ëœ `ROOT_FOLDER_ID` í•˜ìœ„ì— `ë‹¨ì§€ëª… > ë§¤ë¬¼ > ë™-í˜¸` êµ¬ì¡°ë¡œ í´ë”ë¥¼ ìƒì„±í•œë‹¤. (ì´ë¯¸ ì¡´ì¬í•˜ë©´ ìƒì„±í•˜ì§€ ì•ŠìŒ)
        
    3. ìµœì¢… ìƒì„±ëœ í´ë”ì˜ URLì„ `C24` ì…€ì— ì…ë ¥í•œë‹¤.
        
    4. ì‚¬ìš©ìê°€ ë°”ë¡œ íŒŒì¼ì„ ì—…ë¡œë“œí•  ìˆ˜ ìˆë„ë¡ í•´ë‹¹ í´ë”ë¥¼ ìƒˆ íƒ­ìœ¼ë¡œ ì—´ì–´ì¤€ë‹¤.
        

---

## 4. ìŠ¤í¬ë¦½íŠ¸ ì„¤ì • ë° í™˜ê²½ ë³€ìˆ˜

### 4.1. í™˜ê²½ ë³€ìˆ˜

ìŠ¤í¬ë¦½íŠ¸ ìƒë‹¨ì— ì •ì˜ëœ ìƒìˆ˜ë¡œ, ì‚¬ìš©ìì˜ í™˜ê²½ì— ë§ê²Œ ìˆ˜ì •ì´ í•„ìš”í•  ìˆ˜ ìˆë‹¤.

- **`ROOT_FOLDER_ID`**: ëª¨ë“  ë§¤ë¬¼ ê´€ë ¨ í´ë”ê°€ ìƒì„±ë  Google Driveì˜ ìµœìƒìœ„ í´ë” ID.
    
    - **ì°¾ëŠ” ë°©ë²•**: í•´ë‹¹ í´ë”ë¥¼ ì›¹ì—ì„œ ì—´ì—ˆì„ ë•Œ, ë¸Œë¼ìš°ì € ì£¼ì†Œì°½ì˜ `.../folders/` ë’¤ì— ìˆëŠ” ê¸´ ë¬¸ìì—´.
        

### 4.2. ë²„íŠ¼ ë° ë©”ë‰´ í• ë‹¹

- **[ë“±ë¡í•˜ê¸°] ë²„íŠ¼**: `registerPropertyAndClient` í•¨ìˆ˜ í• ë‹¹
    
- **[ë¶ˆëŸ¬ì˜¤ê¸°] ë²„íŠ¼**: `loadPropertyData` í•¨ìˆ˜ í• ë‹¹
    
- **ìƒë‹¨ ë©”ë‰´**: `onOpen` í•¨ìˆ˜ê°€ ì‹œíŠ¸ë¥¼ ì—´ ë•Œ ìë™ìœ¼ë¡œ ìƒì„±í•˜ë©°, `createAndLinkFolder` í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•œë‹¤.
    

### 4.3. ì „ì²´ ìŠ¤í¬ë¦½íŠ¸ ì½”ë“œ

JavaScript

```
/**
 * =====================================================================================
 * ë¶€ë™ì‚° ë§¤ë¬¼ê´€ë¦¬ ìë™í™” ì‹œìŠ¤í…œ - ìµœì¢… ìŠ¤í¬ë¦½íŠ¸
 * =====================================================================================
 * ê¸°ëŠ¥: ë§ì¶¤ ë©”ë‰´, í´ë” ìë™ ìƒì„±/ë§í¬, ê¸°ì¡´ ë°ì´í„° ë¶ˆëŸ¬ì˜¤ê¸°, ì‹ ê·œ/ìˆ˜ì • ìë™ ì²˜ë¦¬
 */

// 'ì•„íŒŒíŠ¸' í´ë”ì˜ ê³ ìœ  IDë¥¼ ìƒìˆ˜ë¡œ ì§€ì •í•©ë‹ˆë‹¤.
const ROOT_FOLDER_ID = '1FX38mD_41LdOam8niRpxHoZRj7gZqIUW';

/**
 * ìŠ¤í”„ë ˆë“œì‹œíŠ¸ë¥¼ ì—´ ë•Œë§ˆë‹¤ ìƒë‹¨ì— ë§ì¶¤ ë©”ë‰´ë¥¼ ìƒì„±í•©ë‹ˆë‹¤.
 */
function onOpen() {
  SpreadsheetApp.getUi()
    .createMenu('ğŸ“ ë§¤ë¬¼ í´ë” ê´€ë¦¬')
    .addItem('ê´€ë ¨íŒŒì¼ í´ë” ìƒì„± ë° ë§í¬', 'createAndLinkFolder')
    .addToUi();
}

/**
 * 'ë“±ë¡ê²€ìƒ‰' ì‹œíŠ¸ì˜ ì •ë³´ë¥¼ ë°”íƒ•ìœ¼ë¡œ êµ¬ê¸€ ë“œë¼ì´ë¸Œì— í´ë”ë¥¼ ìƒì„±í•˜ê³ ,
 * í•´ë‹¹ í´ë”ì˜ ë§í¬ë¥¼ C24ì…€ì— ì…ë ¥í•œ ë’¤ ìƒˆ íƒ­ìœ¼ë¡œ ì—´ì–´ì¤ë‹ˆë‹¤.
 */
function createAndLinkFolder() {
  const ss = SpreadsheetApp.getActiveSpreadsheet();
  const sheet = ss.getSheetByName('ë“±ë¡ê²€ìƒ‰');
  
  const apartmentName = sheet.getRange('C4').getValue();
  const dong = sheet.getRange('C5').getValue();
  const ho = sheet.getRange('C6').getValue();
  
  if (!apartmentName || !dong || !ho) {
    Browser.msgBox('ì…ë ¥ ì˜¤ë¥˜', 'í´ë”ë¥¼ ìƒì„±í•˜ë ¤ë©´ ë‹¨ì§€ëª…, ë™, í˜¸ë¥¼ ë¨¼ì € ì…ë ¥í•´ì•¼ í•©ë‹ˆë‹¤.', Browser.Buttons.OK);
    return;
  }
  
  try {
    const rootFolder = DriveApp.getFolderById(ROOT_FOLDER_ID);
    const apartmentFolder = getOrCreateFolder(rootFolder, apartmentName);
    const listingsFolder = getOrCreateFolder(apartmentFolder, 'ë§¤ë¬¼');
    const finalFolderName = `${dong}-${ho}`;
    const finalFolder = getOrCreateFolder(listingsFolder, finalFolderName);
    const folderUrl = finalFolder.getUrl();
    sheet.getRange('C24').setValue(folderUrl);
    openUrlInNewTab(folderUrl, 'íŒŒì¼ ì—…ë¡œë“œ í´ë” ì—¬ëŠ” ì¤‘...');
    
  } catch (e) {
    Browser.msgBox('ìŠ¤í¬ë¦½íŠ¸ ì˜¤ë¥˜', `í´ë” ìƒì„± ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: ${e.toString()}`, Browser.Buttons.OK);
  }
}

/**
 * 'ë§¤ë¬¼DB'ì—ì„œ ê¸°ì¡´ ë§¤ë¬¼ ì •ë³´ë¥¼ ì°¾ì•„ 'ë“±ë¡ê²€ìƒ‰' ì‹œíŠ¸ë¡œ ë¶ˆëŸ¬ì˜µë‹ˆë‹¤.
 */
function loadPropertyData() {
  const ss = SpreadsheetApp.getActiveSpreadsheet();
  const sheet = ss.getSheetByName('ë“±ë¡ê²€ìƒ‰');
  const propertyDb = ss.getSheetByName('ë§¤ë¬¼DB');

  const status = sheet.getRange('C3').getValue();
  if (status.indexOf('ì‹ ê·œ') !== -1) {
    Browser.msgBox('ì•Œë¦¼', 'ì‹ ê·œ ë§¤ë¬¼ì…ë‹ˆë‹¤. ë¶ˆëŸ¬ì˜¬ ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.', Browser.Buttons.OK);
    return;
  }

  const apartmentName = sheet.getRange('C4').getValue();
  const dong = sheet.getRange('C5').getValue();
  const ho = sheet.getRange('C6').getValue();

  if (!apartmentName || !dong || !ho) {
    Browser.msgBox('ì…ë ¥ ì˜¤ë¥˜', 'ë‹¨ì§€ëª…, ë™, í˜¸ë¥¼ ë¨¼ì € ì…ë ¥í•´ì£¼ì„¸ìš”.', Browser.Buttons.OK);
    return;
  }
  
  const dbData = propertyDb.getDataRange().getValues();
  const headers = dbData[0].map(h => h.toString().trim());
  let targetRow = null;

  for (let i = 1; i < dbData.length; i++) {
    if (dbData[i][headers.indexOf('ë‹¨ì§€ëª…')] == apartmentName && dbData[i][headers.indexOf('ë™')] == dong && dbData[i][headers.indexOf('í˜¸')] == ho) {
      targetRow = dbData[i];
      break;
    }
  }

  if (targetRow) {
    const labelsRange = sheet.getRange('B4:B50').getValues();
    for (let i = 0; i < labelsRange.length; i++) {
      const label = labelsRange[i][0].toString().trim();
      if (label) {
        const colIndex = headers.indexOf(label);
        if (colIndex !== -1) {
          sheet.getRange(i + 4, 3).setValue(targetRow[colIndex]);
        }
      }
    }
    Browser.msgBox('ì„±ê³µ', 'ê¸°ì¡´ ë§¤ë¬¼ ì •ë³´ë¥¼ ì„±ê³µì ìœ¼ë¡œ ë¶ˆëŸ¬ì™”ìŠµë‹ˆë‹¤.', Browser.Buttons.OK);
  } else {
    Browser.msgBox('ì˜¤ë¥˜', 'ë°ì´í„°ë² ì´ìŠ¤ì—ì„œ ì¼ì¹˜í•˜ëŠ” ë§¤ë¬¼ì„ ì°¾ì§€ ëª»í–ˆìŠµë‹ˆë‹¤.', Browser.Buttons.OK);
  }
}

/**
 * 'ë“±ë¡ê²€ìƒ‰' ì‹œíŠ¸ì˜ ë°ì´í„°ë¥¼ 'ì‹ ê·œ ë“±ë¡' í•˜ê±°ë‚˜ ê¸°ì¡´ ë°ì´í„°ë¥¼ 'ìˆ˜ì •(ë®ì–´ì“°ê¸°)' í•©ë‹ˆë‹¤.
 */
function registerPropertyAndClient() {
  const ss = SpreadsheetApp.getActiveSpreadsheet();
  const regSheet = ss.getSheetByName('ë“±ë¡ê²€ìƒ‰');
  const propertyDb = ss.getSheetByName('ë§¤ë¬¼DB');
  const customerDb = ss.getSheetByName('ê³ ê°DB');

  const status = regSheet.getRange('C3').getValue();

  const rangeData = regSheet.getRange('B4:C50').getValues();
  let dataMap = {};
  for (let i = 0; i < rangeData.length; i++) {
    if (rangeData[i][0] !== '') {
      let key = rangeData[i][0].toString().trim();
      dataMap[key] = rangeData[i][1];
    }
  }

  if (!dataMap['ë‹¨ì§€ëª…']) {
    Browser.msgBox('ì˜¤ë¥˜', 'í•„ìˆ˜ í•­ëª©ì¸ ë‹¨ì§€ëª…ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.', Browser.Buttons.OK);
    return;
  }
  if (!dataMap['ì ‘ìˆ˜ì¼']) {
    dataMap['ì ‘ìˆ˜ì¼'] = new Date();
  }

  const propertyHeaders = propertyDb.getRange(1, 1, 1, propertyDb.getLastColumn()).getValues()[0].map(h => h.toString().trim());
  const customerHeaders = customerDb.getRange(1, 1, 1, customerDb.getLastColumn()).getValues()[0].map(h => h.toString().trim());

  let newPropertyRow = propertyHeaders.map(header => dataMap[header] !== undefined ? dataMap[header] : null);
  let newCustomerRow = customerHeaders.map(header => dataMap[header] !== undefined ? dataMap[header] : null);

  if (status.indexOf('ì‹ ê·œ') !== -1) {
    propertyDb.appendRow(newPropertyRow);
    customerDb.appendRow(newCustomerRow);
    SpreadsheetApp.flush();
    Browser.msgBox('ì„±ê³µ', 'ì‹ ê·œ ë§¤ë¬¼ ë° ê³ ê° ì •ë³´ê°€ ì„±ê³µì ìœ¼ë¡œ ë“±ë¡ë˜ì—ˆìŠµë‹ˆë‹¤.', Browser.Buttons.OK);
  } else {
    const dbData = propertyDb.getDataRange().getValues();
    let updated = false;
    for (let i = 1; i < dbData.length; i++) {
      if (dbData[i][propertyHeaders.indexOf('ë‹¨ì§€ëª…')] == dataMap['ë‹¨ì§€ëª…'] && dbData[i][propertyHeaders.indexOf('ë™')] == dataMap['ë™'] && dbData[i][propertyHeaders.indexOf('í˜¸')] == dataMap['í˜¸']) {
        propertyDb.getRange(i + 1, 1, 1, newPropertyRow.length).setValues([newPropertyRow]);
        
        updated = true;
        break;
      }
    }
    
    if(updated) {
        Browser.msgBox('ì„±ê³µ', 'ë§¤ë¬¼ ì •ë³´ê°€ ì„±ê³µì ìœ¼ë¡œ ìˆ˜ì •ë˜ì—ˆìŠµë‹ˆë‹¤.', Browser.Buttons.OK);
    } else {
        Browser.msgBox('ì˜¤ë¥˜', 'ìˆ˜ì •í•  ì›ë³¸ ë°ì´í„°ë¥¼ ì°¾ì§€ ëª»í–ˆìŠµë‹ˆë‹¤. ì‹ ê·œ ë“±ë¡ìœ¼ë¡œ ì§„í–‰í•´ì£¼ì„¸ìš”.', Browser.Buttons.OK);
        return; 
    }
  }

  const clearRanges = ['C4:C27', 'C29', 'C30:C35'];
  clearRanges.forEach(range => regSheet.getRange(range).clearContent());
}

// =====================================================================================
//                          í—¬í¼(Helper) í•¨ìˆ˜ë“¤ (ìˆ˜ì • X)
// =====================================================================================
function getOrCreateFolder(parentFolder, folderName) {
  const folders = parentFolder.getFoldersByName(folderName);
  return folders.hasNext() ? folders.next() : parentFolder.createFolder(folderName);
}

function openUrlInNewTab(url, title) {
  const html = `<script>window.open('${url}', '_blank');google.script.host.close();</script>`;
  const userInterface = HtmlService.createHtmlOutput(html).setHeight(10);
  SpreadsheetApp.getUi().showModalDialog(userInterface, title);
}
```

