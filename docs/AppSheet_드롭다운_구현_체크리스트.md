# AppSheet 드롭다운 구현 체크리스트

## 📋 실행 계획 개요

**목표**: 고정값 시트(`1cFePAgehODmcTiPoWoDKOg2kIZSd2Zu2ZaiFL36ucVE`)를 활용한 일관된 데이터 입력 시스템 구축

**구현 순서**: 간단한 것부터 → 복잡한 것 (Enum → Ref → Valid_If)

---

## ✅ Phase 1: 간단한 Enum 드롭다운 (5-10분)

### 1-1. 거래유형 설정

**작업 시간**: 5분
**난이도**: ⭐ (매우 쉬움)

#### 실행 단계
```
□ AppSheet 열기 → 앱 선택
□ 왼쪽 메뉴: Data 클릭
□ Tables: 아파트매물 선택
□ Columns 탭 클릭
□ 거래유형 컬럼 찾아서 클릭
```

#### 설정값 입력
```
□ Type: Enum 선택

□ Type Details 섹션:
   Base type: Text (기본값, 변경 안 함)

   Values: (한 줄씩 입력)
   매매
   전세
   월세
   임대

□ Data Validity 섹션:
   Allow other values: ❌ (체크 해제)

□ Input mode: Dropdown (기본값, 확인만)

□ Save 클릭
```

#### 검증 방법
```
□ 앱 미리보기 (Preview) 클릭
□ 아파트매물 Form 열기
□ 거래유형 필드 클릭
□ 드롭다운에 "매매, 전세, 월세, 임대" 4개 항목만 표시되는지 확인 ✅
```

---

### 1-2. 난방방식 설정

**작업 시간**: 3분
**난이도**: ⭐ (매우 쉬움)

#### 실행 단계
```
□ Data → Columns → 아파트매물 → 난방방식

□ Type: Enum

□ Values:
   개별난방
   중앙난방
   지역난방
   기타

□ Allow other values: ❌

□ Save
```

#### 검증
```
□ Preview → 난방방식 필드 클릭
□ 4개 난방 옵션만 표시 확인 ✅
```

---

### 1-3. 고객구분 설정 (고객DB)

**작업 시간**: 3분
**난이도**: ⭐ (매우 쉬움)

#### 실행 단계
```
□ Data → Tables → 고객DB → Columns → 고객구분

□ Type: Enum

□ Values:
   매도인
   임대인
   임차인
   손님
   타부동산
   분양직원

□ Allow other values: ❌

□ Save
```

#### 검증
```
□ Preview → 고객DB Form → 고객구분 필드
□ 6개 고객 구분 옵션 표시 확인 ✅
```

---

## ✅ Phase 2: 행정구역 계층 구조 (20-30분)

### 2-1. 참조 테이블 추가 (시도, 시군구, 동읍면, 통반리)

**작업 시간**: 10분
**난이도**: ⭐⭐ (중간)

#### 시도 테이블 추가
```
□ Data 메뉴
□ + (Add table 버튼) 클릭
□ Data source: Google Sheets 선택
□ Spreadsheet: "1cFePAgehODmcTiPoWoDKOg2kIZSd2Zu2ZaiFL36ucVE" 입력
□ Sheet: "시도" 선택
□ Table name: "시도" (자동 입력됨)
□ Add table 클릭
```

#### 시군구 테이블 추가
```
□ 동일한 방법으로 "시군구" 시트 추가
□ Spreadsheet ID: 1cFePAgehODmcTiPoWoDKOg2kIZSd2Zu2ZaiFL36ucVE
□ Sheet: "시군구"
```

#### 동읍면 테이블 추가
```
□ "동읍면" 시트 추가
□ Spreadsheet ID: 1cFePAgehODmcTiPoWoDKOg2kIZSd2Zu2ZaiFL36ucVE
□ Sheet: "동읍면"
```

#### 통반리 테이블 추가
```
□ "통반리" 시트 추가
□ Spreadsheet ID: 1cFePAgehODmcTiPoWoDKOg2kIZSd2Zu2ZaiFL36ucVE
□ Sheet: "통반리"
```

#### 검증
```
□ Data → Tables 목록에서 확인:
   - 시도 ✅
   - 시군구 ✅
   - 동읍면 ✅
   - 통반리 ✅
```

---

### 2-2. 시도 필드 설정 (Ref)

**작업 시간**: 5분
**난이도**: ⭐⭐ (중간)

#### 전제 조건 확인
```
□ 아파트매물 테이블에 "시도" 컬럼이 있는지 확인
□ 없으면: Data → Columns → + Add column → Name: "시도"
```

#### 실행 단계
```
□ Data → Columns → 아파트매물 → 시도

□ Type: Ref

□ Type Details:
   Source table: 시도 (드롭다운에서 선택)

   Label column: (자동으로 설정되는 값 확인, 보통 첫 번째 텍스트 컬럼)
   → 시트 구조에 따라 "시도명" 또는 "이름" 등

□ Input mode: Dropdown

□ Save
```

#### 검증
```
□ Preview → 아파트매물 Form
□ 시도 필드 클릭
□ 드롭다운에 시도 목록 (서울특별시, 경기도, 충청남도 등) 표시 확인 ✅
```

---

### 2-3. 시군구 필드 설정 (Valid_If - 조건부 필터링)

**작업 시간**: 7분
**난이도**: ⭐⭐⭐ (어려움)

#### 전제 조건 확인
```
□ 시군구 시트 구조 파악:
   - 어떤 컬럼명으로 시도와 연결되는지 확인
   - 예: "시도" 또는 "상위지역" 컬럼

□ 시군구 시트에 시도 참조 컬럼이 있어야 함
   예: | 시도 | 시군구명 |
       | 충청남도 | 천안시 |
       | 충청남도 | 아산시 |
```

#### 실행 단계
```
□ Data → Columns → 아파트매물 → 시군구

□ Type: Text (Ref가 아님!)

□ Data Validity 섹션으로 스크롤

□ Valid If 필드에 수식 입력:
   SELECT(시군구[시군구명], [시도] = [_THISROW].[시도])

   ⚠️ 주의:
   - "시군구명"은 실제 시군구 시트의 컬럼명에 맞게 수정
   - "시도"는 시군구 시트에서 상위 지역을 나타내는 컬럼명

□ Input mode: Dropdown

□ Save
```

#### Valid_If 수식 설명
```
SELECT(
  시군구[시군구명],           # 시군구 테이블에서 시군구명 컬럼 가져오기
  [시도] = [_THISROW].[시도]  # 조건: 시군구의 시도 = 현재 행의 시도
)

예시:
- 사용자가 시도에서 "충청남도" 선택
- 시군구 드롭다운에는 시군구 테이블에서 [시도] = "충청남도"인 것만 표시
- 결과: 천안시, 아산시, 당진시 등만 나타남 (서울, 경기 제외)
```

#### 검증
```
□ Preview → 아파트매물 Form
□ 시도: "충청남도" 선택
□ 시군구 필드 클릭
□ 드롭다운에 충청남도 소속 시군구만 표시되는지 확인 ✅
   (서울, 경기 등 다른 지역은 안 나옴)
```

---

### 2-4. 동읍면 필드 설정 (Valid_If)

**작업 시간**: 5분
**난이도**: ⭐⭐⭐ (어려움)

#### 실행 단계
```
□ Data → Columns → 아파트매물 → 동읍면

□ Type: Text

□ Valid If:
   SELECT(동읍면[동읍면명], [시군구] = [_THISROW].[시군구])

□ Input mode: Dropdown

□ Save
```

#### 검증
```
□ Preview
□ 시도: "충청남도" → 시군구: "아산시" 선택
□ 동읍면 클릭 → 아산시 소속 동읍면만 표시 확인 ✅
```

---

### 2-5. 통반리 필드 설정 (Valid_If)

**작업 시간**: 5분
**난이도**: ⭐⭐⭐ (어려움)

#### 실행 단계
```
□ Data → Columns → 아파트매물 → 통반리

□ Type: Text

□ Valid If:
   SELECT(통반리[통반리명], [동읍면] = [_THISROW].[동읍면])

□ Save
```

#### 전체 검증
```
□ Preview → 아파트매물 Form
□ 시도: "충청남도" 선택
□ 시군구: "아산시" 선택
□ 동읍면: "탕정면" 선택
□ 통반리: 탕정면 소속만 표시되는지 확인 ✅

계층 구조 작동 확인:
시도 → 시군구 → 동읍면 → 통반리 (4단계 필터링)
```

---

## ✅ Phase 3: 복잡한 속성 데이터 (향후 작업)

### 3-1. 데이터 정리 필요 (Google Sheets 작업)

**현재 상태**: 데이터확인_list 시트에 여러 속성이 혼재

**권장 작업**: 고정값 스프레드시트에 개별 시트 생성

#### 생성할 시트 목록
```
□ 용도지역 시트
   A열: 코드 (예: UZ01)
   B열: 용도지역명 (예: 제1종전용주거지역)

□ 지목 시트
   A열: 코드
   B열: 지목명 (전, 답, 과수원, 대지, 임야 등)

□ 주택유형 시트
   A열: 코드
   B열: 유형명 (아파트, 빌라, 단독주택, 오피스텔 등)

□ 건축물구조 시트
   A열: 코드
   B열: 구조명 (철근콘크리트, 철골조, 경량철골 등)
```

---

### 3-2. AppSheet 적용 (데이터 정리 후)

#### 용도지역 Ref 설정
```
□ Data → + New table → 용도지역 시트 추가
□ Data → Columns → 아파트매물 → 용도지역
□ Type: Ref
□ Source table: 용도지역
□ Label column: 용도지역명
```

#### 지목 Ref 설정
```
□ 동일 방식으로 지목 시트 추가 및 Ref 설정
```

#### 주택유형 Ref 설정
```
□ 주택유형 시트 추가 및 Ref 설정
```

#### 건축물구조 Ref 설정
```
□ 건축물구조 시트 추가 및 Ref 설정
```

---

## 📊 진행 상황 추적

### Phase 1: Enum 드롭다운 ✅
- [ ] 거래유형 (매매, 전세, 월세, 임대)
- [ ] 난방방식 (개별, 중앙, 지역, 기타)
- [ ] 고객구분 (매도인, 임대인, 임차인, 손님, 타부동산, 분양직원)

### Phase 2: 행정구역 계층 구조 ⏳
- [ ] 시도, 시군구, 동읍면, 통반리 테이블 추가
- [ ] 시도 Ref 설정
- [ ] 시군구 Valid_If 설정
- [ ] 동읍면 Valid_If 설정
- [ ] 통반리 Valid_If 설정

### Phase 3: 복잡한 속성 (향후) 📅
- [ ] 용도지역 데이터 정리 → Ref 설정
- [ ] 지목 데이터 정리 → Ref 설정
- [ ] 주택유형 데이터 정리 → Ref 설정
- [ ] 건축물구조 데이터 정리 → Ref 설정

---

## 🚨 주의사항 및 트러블슈팅

### 1. Valid_If 수식 오류
```
오류: "Column not found"
→ 해결: 컬럼명 대소문자, 띄어쓰기 정확히 확인
→ 시군구 시트에 실제로 "시도" 컬럼이 있는지 확인

오류: "Type mismatch"
→ 해결: 비교하는 두 컬럼의 Type이 동일한지 확인
→ 시도가 Text면 시군구의 시도 참조도 Text여야 함
```

### 2. 드롭다운이 비어 있음
```
원인 1: 데이터 Sync 안 됨
→ 해결: AppSheet 우측 상단 Sync 버튼 클릭

원인 2: Valid_If 조건이 너무 엄격
→ 해결: 수식 조건 확인, 일부러 조건 제거하고 테스트

원인 3: 참조 시트에 데이터가 없음
→ 해결: Google Sheets에서 시트 확인
```

### 3. 참조 테이블이 AppSheet에 안 보임
```
→ Spreadsheet ID 다시 확인
→ Sheet 이름 정확히 입력했는지 확인
→ Google Sheets에서 해당 시트가 실제로 존재하는지 확인
```

---

## 💡 성공 체크리스트

### Phase 1 완료 기준
```
✅ 거래유형 드롭다운에 4개 항목만 표시
✅ 난방방식 드롭다운에 4개 항목만 표시
✅ 고객구분 드롭다운에 6개 항목만 표시
✅ 수동 입력 불가능 (Allow other values = OFF)
```

### Phase 2 완료 기준
```
✅ 시도 선택 → 시군구 드롭다운 자동 필터링
✅ 시군구 선택 → 동읍면 드롭다운 자동 필터링
✅ 동읍면 선택 → 통반리 드롭다운 자동 필터링
✅ 계층 구조 4단계 모두 작동
```

---

## 🎯 다음 단계 제안

### 완료 후 추가 개선 사항
1. **성별 필드** (고객DB)
   - Type: Enum
   - Values: 남, 여

2. **담당자 필드**
   - 사용자 테이블 생성 후 Ref 설정
   - 또는 간단히 Enum으로 직원 이름 리스트

3. **월부담(월구조) 필드**
   - Type: Text (자유 입력)
   - Suggested values: 1.5룸, 2룸, 3룸, 4룸 등

---

## 📞 도움 요청 시 포함할 정보

문제 발생 시 다음 정보를 제공하면 빠른 해결 가능:

1. **스크린샷**: 에러 메시지 또는 문제 화면
2. **설정값**: Type, Values, Valid_If 수식 등
3. **시트 구조**: Google Sheets 컬럼명 목록
4. **예상 동작**: 어떻게 작동하길 원하는지
5. **실제 동작**: 현재 어떻게 작동하는지

---

**작성일**: 2025-10-18
**버전**: 1.0
**참고 문서**: [AppSheet_고정값_드롭다운_설정.md](AppSheet_고정값_드롭다운_설정.md)
