# Excel VBA Folder Creator

이 폴더는 Google Apps Script(`apps-script/folder_create.js`)의 기능을 엑셀 VBA로 이식한 코드를 포함하고 있습니다.
구글 드라이브 대신 **사용자의 로컬 OneDrive 폴더**를 사용하여 동일한 폴더 구조를 자동 생성합니다.

## 구성 요소

- `FolderCreator.bas`: 폴더 생성 핵심 로직이 담긴 VBA 모듈 파일

## 설치 및 사용 방법

### 1단계: VBA 모듈 가져오기
작업 중인 각 엑셀 파일(**아파트.xlsx**, **근생.xlsx**, **주택_공장_토지.xlsx**)에 이 매크로를 포함시켜야 합니다.

1. `아파트.xlsx`를 엽니다.
2. `Alt + F11`을 눌러 VBA 편집기를 엽니다.
3. 프로젝트 탐색기(왼쪽 트리 메뉴)에서 우클릭 > `파일 가져오기(Import File)`를 선택합니다.
4. `FolderCreator.bas` 파일을 선택하여 가져옵니다.
5. `근생.xlsx`, `주택_공장_토지.xlsx` 파일에도 **동일한 과정**을 반복합니다.

### 2단계: 설정 (선택 사항)
기본적으로 이 스크립트는 **각 엑셀 파일이 있는 폴더**를 최상위 경로로 사용합니다.
따라서 3개의 엑셀 파일을 모두 `OneDrive/부동산업무/` 폴더 안에 넣어두시면, 그 안에서 `통합매물데이터/아산시/...` 와 같이 폴더가 생성됩니다.

만약 모든 파일이 하나의 공통된 루트(예: `D:\Data`)를 바라보게 하고 싶다면:
1. 각 엑셀 파일에서 `수식` > `이름 관리자` (Name Manager) 메뉴로 이동합니다.
2. `새로 만들기`를 클릭합니다.
3. 이름: `RootPath`
4. 참조 대상: `="D:\Desired\Path"` 와 같이 경로 입력
   - 이렇게 하면 파일 위치와 상관없이 지정된 곳에 폴더가 모입니다.

### 3단계: 시트 이벤트 연결
작동시키려는 시트(예: `아파트매물`)의 코드 모듈에 아래 코드를 붙여넣으세요.
(VBA 편집기 왼쪽 메뉴에서 `Microsoft Excel 개체` > `Sheet1 (아파트매물)` 더블 클릭)

```vba
Private Sub Worksheet_Change(ByVal Target As Range)
    ' FolderCreator 모듈의 HandleChange 함수 호출
    FolderCreator.HandleChange Target
End Sub
```

이제 시트에서 데이터를 입력하고 모든 필수 항목이 채워지면, 자동으로 지정된 경로에 폴더가 생성되고 `관련파일` 열에 경로가 입력됩니다.

## 주요 기능

- **자동 폴더 생성**: 데이터 입력 시 즉시 폴더 생성
- **구조**: `통합매물데이터/지역/동읍면/통반리/...` (기존 규칙 동일)
- **중복 방지**: 이미 URL/경로가 있는 행은 건너뜀

## 🚀 대량 폴더 생성 (Batch Processing)

기존에 입력된 수많은 데이터를 한 번에 처리하려면:

### 방법 A: 엑셀 매크로 사용
1. VBA 편집기에서 `FolderCreator` 모듈을 확인합니다.
2. `ProcessAllRows`라는 매크로가 추가되어 있습니다.
3. 엑셀에서 `개발 도구` > `매크로` > `ProcessAllRows` 실행
   - 현재 시트의 모든 행을 검사하여 폴더를 생성합니다.

### 방법 B: 파이썬 스크립트 사용 (추천)
여러 파일의 폴더를 한 번에 빠르게 만들고 싶다면:
1. `create_folders_batch.py` 파일을 실행하세요.
2. `아파트.xlsx`, `근생.xlsx`, `주택 공장 토지.xlsx`를 모두 읽어서 폴더를 생성합니다.

## 주의사항
- **파일 이름**: `주택 공장 토지.xlsx` (공백 포함) 파일명을 코드가 인식하도록 설정했습니다.
- 매크로가 포함된 엑셀 파일(`.xlsm`)로 저장해야 `HandleChange` 이벤트가 작동합니다.
- 엑셀 보안 설정에서 매크로 실행이 허용되어야 합니다.
