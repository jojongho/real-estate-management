# 🏗️ 프로젝트 구조 다이어그램

아파트 매물관리 자동화 시스템의 전체 구조와 흐름을 시각적으로 설명합니다.

## 📁 프로젝트 디렉토리 구조

```
apartment-automation/                          # 📁 프로젝트 루트
├── 📁 src/                                    # 🐍 Python 소스 코드
│   ├── 📁 collectors/                         # 📥 데이터 수집 모듈
│   │   ├── csv_importer.py                    # 📊 CSV 파일 가져오기
│   │   ├── pdf_parser.py                      # 📄 PDF 파싱 및 정보 추출
│   │   ├── naver_crawler.py                   # 🕷️ 네이버 부동산 크롤링
│   │   └── api_client.py                     # 🔌 실거래가 API 연동
│   ├── 📁 processors/                         # ⚙️ 데이터 처리 모듈
│   │   ├── normalizer.py                      # 🧹 데이터 정규화
│   │   └── validator.py                       # ✔️ 데이터 유효성 검사
│   ├── 📁 generators/                         # 📝 콘텐츠 생성 모듈
│   │   ├── briefing.py                        # 📋 일일 브리핑 생성
│   │   ├── marketing.py                       # 💼 마케팅 문구 생성
│   │   └── instagram.py                       # 📸 인스타그램 이미지 생성
│   ├── 📁 sheets/                             # 📊 Google Sheets 연동
│   │   ├── writer.py                          # ✍️ 데이터 쓰기
│   │   └── reader.py                          # 👁️ 데이터 읽기
│   ├── 📁 config/                             # ⚙️ 설정 관리
│   │   └── settings.py                        # 🔧 시스템 설정 중앙 관리
│   └── main.py                                # 🚀 메인 엔트리 포인트
├── 📁 apps-script/                            # 📱 Google Apps Script
│   ├── 통합_최종_스크립트.js                     # 🎯 메인 스크립트 (매물 등록 자동화)
│   ├── 매물등록수정_통합스크립트.js               # 📝 매물 등록/수정 통합 처리
│   ├── 매물저장_앱스스크립트.js                  # 💾 매물 데이터 저장
│   ├── 옵션불러오기_앱스스크립트.js              # 🔽 옵션 데이터 불러오기
│   └── 원본_매물등록수정_스크립트.js             # 📂 백업 스크립트
├── 📁 workflows/                              # 🔄 n8n 워크플로우
│   ├── n8n-workflow-read-sheets.json          # 📖 시트 읽기 워크플로우
│   └── n8n-workflow-read-normalized-sheets.json # 📊 정규화된 시트 읽기
├── 📁 data/                                   # 💾 데이터 저장소
│   ├── 📁 raw/                                # 📄 원본 파일들
│   │   ├── 통합단지DB - 분양가.csv             # 💰 분양가 데이터
│   │   ├── 통합단지DB - 옵션.csv               # ⚙️ 옵션 정보
│   │   ├── 통합단지DB - 타입.csv               # 🏠 타입 정보
│   │   ├── 통합단지DB - 발코니.csv             # 🌿 발코니 정보
│   │   └── 통합단지DB - 단지일정.csv           # 📅 단지 일정
│   └── 📁 processed/                          # 🏭 가공된 데이터
├── 📁 config/                                 # ⚙️ 설정 파일들
│   ├── settings.yaml                          # 🗂️ 시스템 설정
│   └── credentials.json                       # 🔑 Google 인증 정보 (별도 설정 필요)
├── 📁 tests/                                  # 🧪 테스트 코드
├── 📁 docs/                                   # 📚 문서
│   ├── API-reference.md                       # 📖 API 참조 문서
│   ├── setup-guide.md                         # 🛠️ 설치 및 설정 가이드
│   └── project-structure.md                   # 🏗️ 프로젝트 구조 문서 (현재 파일)
├── 📁 logs/                                   # 📝 로그 파일들
├── 📄 .gitignore                             # 🚫 Git 무시 파일 목록
├── 📄 README.md                              # 📋 프로젝트 소개 문서
├── 📄 requirements.txt                       # 🐍 Python 의존성 목록
├── 📄 package.json                           # 📦 Node.js 의존성 (기록용)
└── 📄 env.example                            # 🔧 환경 변수 템플릿
```

## 🔄 시스템 데이터 흐름

```
┌─────────────────────────────────────────────────────────────────┐
│                        📥 데이터 수집 단계                        │
└─────────────────────────────────────────────────────────────────┘
                              │
                    📊 CSV 파일       📄 PDF 파일        🕷️ 웹 크롤링
                              │              │              │
                              ▼              ▼              ▼
┌─────────────────────────────────────────────────────────────────┐
│                         ⚙️ 데이터 처리 단계                       │
│                                                                 │
│  collectors/           processors/                              │
│  ├─ csv_importer      ├─ normalizer                            │
│  ├─ pdf_parser        └─ validator                             │
│  ├─ naver_crawler                                              │
│  └─ api_client                                                 │
└─────────────────────────────────────────────────────────────────┘
                              │
                              ▼
┌─────────────────────────────────────────────────────────────────┐
│                    📊 Google Sheets 저장 단계                    │
│                                                                 │
│                        sheets/writer                            │
│                               │                                 │
│                               ▼                                 │
│  ┌─────────────┬─────────────┬─────────────┬─────────────┐      │
│  │ 등록검색 📝 │ 매물DB 🏠   │ 고객DB 👥   │ 아파트단지  │      │
│  │ (인터페이스) │ (핵심 데이터) │ (CRM)      │ (마스터데이터) │      │
│  └─────────────┴─────────────┴─────────────┴─────────────┘      │
└─────────────────────────────────────────────────────────────────┘
                              │
                              ▼
┌─────────────────────────────────────────────────────────────────┐
│                    📱 Apps Script 자동화 단계                    │
│                                                                 │
│                 통합_최종_스크립트.js                            │
│                              │                                 │
│         입력 검증 → 매물ID 생성 → 중복 체크 → 저장               │
└─────────────────────────────────────────────────────────────────┘
                              │
                              ▼
┌─────────────────────────────────────────────────────────────────┐
│                       📝 콘텐츠 생성 단계                        │
│                                                                 │
│      generators/                                                │
│      ├─ briefing      ├─ marketing      ├─ instagram           │
│      │ (일일 브리핑)   │ (마케팅 문구)   │ (이미지 생성)         │
│      │                │                │                      │
│      📋 Google Docs    📱 블로그         📸 SNS 콘텐츠          │
└─────────────────────────────────────────────────────────────────┘
                              │
                              ▼
┌─────────────────────────────────────────────────────────────────┐
│                         📊 분석 및 대시보드                       │
│                                                                 │
│      대시보드 시트                                              │
│      ├─ 피벗 테이블    ├─ 차트        ├─ 통계 요약             │
│      │ (데이터 범위)    │ (시각화)      │ (KPI 지표)             │
└─────────────────────────────────────────────────────────────────┘
```

## 🎯 시트별 역할 및 연동

```
┌─────────────────────────────────────────────────────────────────┐
│                         📊 Google Sheets 구성                   │
└─────────────────────────────────────────────────────────────────┘

등록검색 시트 (사용자 인터페이스)
        │
        ├─ 🖱️ 사용자 입력 (직접 데이터 입력)
        ├─ 🔽 드롭다운 (고정값 시트 참조)
        ├─ 🔗 단지 정보 자동 불러오기 (아파트단지 시트)
        └─ ⚡ Apps Script 자동 처리
             │
             ▼
    ┌─────────────────┬─────────────────┐
    │      매물DB      │      고객DB     │
    │ (핵심 데이터저장) │ (CRM 데이터저장) │
    │                  │                │
    │ • 매물 상세정보   │ • 고객 기본정보 │
    │ • 거래 정보      │ • 상담 이력    │
    │ • 상태 관리      │ • 연락처 관리   │
    │ • 매물ID 생성    │ • 고객ID 생성   │
    └─────────────────┴─────────────────┘
             │                 │
             ▼                 ▼
    ┌─────────────────┐   ┌─────────────────┐
    │   아파트단지     │   │     고정값      │
    │ (마스터 데이터)   │   │ (참조 데이터)    │
    │                  │   │                │
    │ • 단지 기본정보   │   │ • 거래유형     │
    │ • 주소 정보      │   │ • 거래상태     │
    │ • 건축 정보      │   │ • 거래카테고리  │
    │ • 분양 정보      │   │ • 드롭다운 소스 │
    └─────────────────┘   └─────────────────┘
             │
             ▼
    ┌─────────────────────────────────────────┐
    │           대시보드 시트                   │
    │        (분석 및 시각화)                   │
    │                                       │
    │ • 매물 현황 통계                        │
    │ • 거래 유형별 분석                      │
    │ • 월별 접수 추이                        │
    │ • 담당자별 성과                         │
    │ • 실시간 차트                           │
    └─────────────────────────────────────────┘
```

## 🔧 기술 스택 및 역할

### 🐍 Python (+ 프레임워크)
```
📥 데이터 수집 및 처리
├─ pandas: 데이터 조작 및 분석
├─ gspread: Google Sheets API 연동
├─ pdfplumber: PDF 텍스트 추출
├─ playwright: 웹 브라우저 자동화
├─ requests: HTTP 클라이언트
└─ google-generativeai: Gemini API 연동
```

### 📱 Google Apps Script
```
⚡ 실시간 자동화
├─ 매물 등록/수정 처리
├─ 매물ID/고객ID 자동 생성
├─ 중복 검사 및 검증
├─ Google Drive 폴더 생성
├─ 일일 브리핑 생성
└─ 트리거 이벤트 처리
```

### 📊 Google Workspace 플랫폼
```
🎯 중앙 데이터 관리
├─ Google Sheets: 데이터 저장소
├─ Google Drive: 파일 관리
├─ Google Docs: 브리핑 문서
├─ Gmail: 알림 발송
└─ Google Forms: 데이터 입력 폼
```

### 🔄 자동화 워크플로우 (n8n)
```
🤖 워크플로우 오케스트레이션
├─ 데이터 동기화
├─ API 연동 관리
├─ 알림 발송
├─ 에러 처리
└─ 스케줄링 관리
```

## 📅 실행 스케줄 및 트리거

### 🕘 일일 스케줄
```
03:00 │ 📥 새벽 데이터 수집
      │ ├─ 실거래가 API 호출
      │ ├─ 네이버 부동산 크롤링
      │ └─ 데이터 정규화 및 중복 처리
      │
09:00 │ 📝 오전 브리핑 생성
      │ ├─ 일일 신규 매물 요약
      │ ├─ 계약 가능 매물 목록
      │ ├─ Google Docs 자동 생성
      │ └─ 팀원들에게 이메일 발송
      │
12:00 │ 🔄 실시간 데이터 동기화
      │ ├─ Sheets ↔ 외부 시스템 연동
      │ ├─ 데이터 무결성 검사
      │ └─ 알림 상태 업데이트
```

### ⚡ 실시간 트리거
```
신규 매물 등록 →
├─ 매물ID 자동 생성
├─ Google Drive 폴더 생성
├─ 해당 매물 정보 검증
├─ 중복 방지 체크
└─ 알림 발송
```

## 🔒 보안 및 권한 관리

### 🔐 Google API 권한
```
📋 읽기 권한
├─ Google Sheets (시트 읽기)
├─ Google Drive (파일 읽기)
└─ 외부 API (데이터 수집)

✍️ 쓰기 권한
├─ Google Sheets (데이터 업데이트)
├─ Google Drive (폴더/파일 생성)
├─ Google Docs (문서 생성)
└─ Gmail (이메일 발송)

🔑 관리 권한
├─ 사용자 계정 관리
├─ 서비스 계정 권한
└─ API 키 업데이트
```

### 🛡️ 데이터 보안
```
🔒 민감한 정보 보호
├─ 고객 연락처 암호화
├─ API 키 환경 변수 관리
├─ 접근 로그 기록
└─ 데이터 백업 및 복구
```

---

이 프로젝트 구조는 **확장 가능성**과 **유지보수성**을 고려하여 설계되었습니다. 새로운 기능 추가나 데이터 소스 확장이 필요할 때 이 구조를 따라 개발하시면 됩니다.
